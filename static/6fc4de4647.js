function wordToTrigrams(a){if(a.length===0)return[];if(a.length<3)return[a];var b=[];for(var c=0;c<=a.length-3;c+=1)b.push(a.substr(c,3));return b}function tagsToTrigrams(a,b){var c=0,d=b.length;for(;c<d;c+=1)tagToTrigrams(a,b[c])}function tagToTrigrams(a,b){var c=wordToTrigrams(b),d=0,e=c.length,f;for(;d<e;d+=1)f=c[d],trigramTable[f]||(trigramTable[f]=[]),trigramTable[f].push(a)}function search(a){var b=a.toLowerCase().split(" "),c=[],d={};$.each(b,function(a,b){c=c.concat(wordToTrigrams(b))}),$.each(c,function(a,b){if(b in trigramTable){var c=trigramTable[b];for(var e=0;e<c.length;e+=1){var f=c[e];d[f]=d[f]||0,d[f]=d[f]+1}}});var e=[];$.each(d,function(a,b){e.push({code:a,score:b})});if(e.length>0){e.sort(function(a,b){return b.score!==a.score?b.score-a.score:a.code-b.code});var f=Math.ceil(e[0].score/2);return e=$.map(e,function(a,b){if(a.score>f||b<300)return a}),$.map(e,function(a){return a.code})}return[]}var trigramTable={};String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),function(){function a(a){return Math.floor((a-65536)/1024)+55296}function b(a){return(a-65536)%1024+56320}function c(a){if(a<=65535)return"\\u"+(a+65536).toString(16).substr(-4).toUpperCase();throw"Code point outside BMP cannot be encoded."}function d(d){return d<=65535?c(d):c(a(d))+c(b(d))}var e=function(a,b){var c={},d=a.getElementsByTagName(b)[0];return function(e,f){var g;typeof c[e]=="undefined"?(g=a.createElement(b),g.async=!0,g.src=e,f&&(g.onload=function(){g.onloadDone||(g.onloadDone=!0,f())},g.onreadystatechange=function(){(g.readyState==="loaded"||g.readyState==="complete")&&g.onload()}),d.parentNode.insertBefore(g,d),c[e]=g):f&&f()}}(document,"script");document.getElementById("searchField").focus(),document.forms[0].onsubmit=function(){return!1},_gaq=window._gaq||[],_gaq.push(["_setAccount","UA-33198175-1"]),_gaq.push(["_setDomainName","charcod.es"]),_gaq.push(["_trackPageview"]),e(("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js"),e("http://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js",function(){function f(c){_gaq.push(["_trackEvent","search",undefined,c]);var d=[],e=c.match(/^\\u(\d{4})$/),f=c.match(/^&#(\d+);$/)||c.match(/^(\d+)$/);e?d=[parseInt(e[1],16)]:f?d=[f[1]]:d=search(c),c.length===1&&d.length===0&&(d=[c.charCodeAt(0)]),d.length===0?$("#help").show():$("#help").hide(),$("#results").html($.map(d,function(b){var c=a[b].n.indexOf("combining")!==-1,d=(c?"&#9676;":"")+"&#"+b+";";return'<a href="#id'+b+'" id="id'+b+'">'+d+"</a>"}).join("")),d.length===1&&b.activate($("#results a").first())}var a={},b=function(){var b,c,e=function(b){var c=a[b],e=$(".templates .charInfo").clone();_gaq.push(["_trackEvent","popup","activate",c.b]);var f=a[b].n.indexOf("combining")!==-1;e.find("h2").html((f?"&#9676;":"")+"&#"+b+";");var g=["&amp;#"+b+";"];return c.altnames&&c.altnames.html&&g.push("&amp;#"+c.altnames.html+";"),e.find(".char-html").html(g.join("<br>")),e.find(".char-source").html(d(parseInt(b,10))),e.find(".char-codepoint").html(b),c&&(e.find("h3").html(c.n),e.find(".char-group").html(c.b),c.a&&c.a.length>0&&e.find(".aliases").html(c.a.join(", "))),c.altnames&&c.altnames.latex?e.find(".char-latex").html(c.altnames.latex):e.find(".char-latex-row").hide(),e};return{activate:function(a){b&&this.deactivate(),b=a,c=e(a[0].id.replace("id",""));var d=a.position().top,f=a;while(f.next().length&&f.next().position().top===d)f=f.next();c.insertAfter(f),b.addClass("active")},deactivate:function(){b.removeClass("active"),c.remove(),b=c=undefined}}}();$("#results").on("click","a",function(a){b.activate($(a.target)),a.preventDefault()});var c,e=$("#searchField");e.keyup(function(a){c&&window.clearTimeout(c),c=window.setTimeout(function(){f(e.val().trim())},250)}),$(".form-search").submit(function(){return f(e.val().trim()),!1}),$.ajax({url:"data.json",dataType:"json",success:function(b){var c=0,d=b.length,g;for(;c<d;c++){g=b[c],a[g.c]=g,tagsToTrigrams(g.c,g.n.split(" ")),tagsToTrigrams(g.c,[g.b]),g.a&&tagsToTrigrams(g.c,g.a);if(g.altnames)for(var h in g.altnames)tagsToTrigrams(g.c,[g.altnames[h]])}e.val()&&f(e.val())},error:function(){throw new Error("could not load data.json: "+arguments)}})})}()